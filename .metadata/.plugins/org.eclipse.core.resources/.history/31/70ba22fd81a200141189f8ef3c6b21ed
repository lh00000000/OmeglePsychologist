package rewrite;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.util.Arrays;
import java.util.Calendar;

import org.nikki.omegle.Omegle;
import org.nikki.omegle.core.OmegleException;
import org.nikki.omegle.core.OmegleMode;
import org.nikki.omegle.core.OmegleSession;
import org.nikki.omegle.event.OmegleEventAdaptor;

import codeanticode.eliza.Eliza;
import processing.core.PApplet;


public class Rewrite extends PApplet {
	Eliza eliza = new Eliza(this);
	Omegle omegle = new Omegle();
	String lastMessageReceived = "";
	OmegleSession session;
	int countsSinceLastReceivedMessage = 0;

	public void setup() {
		frameRate(1);

		/*
		try {
			System.out.println("Opening session...");
			session = omegle.openSession(OmegleMode.NORMAL, new OmegleEventAdaptor() {
				@Override
				public void chatWaiting(OmegleSession session) {
					System.out.println("Waiting for chat...");
				}

				@Override
				public void chatConnected(OmegleSession session) {
					System.out
					.println("ELIZA is now talking to a random stranger!");
				}

				@Override
				public void chatMessage(OmegleSession session, String message) {
					System.out.println("Stranger: " + message);
					lastMessageReceived = message;
					countsSinceLastReceivedMessage = 0;
				}

				@Override
				public void messageSent(OmegleSession session, String string) {
					System.out.println("You: " + string);
				}

				@Override
				public void strangerDisconnected(OmegleSession session) {
					System.out.println("Stranger disconnected, goodbye!");
					System.out.println(countsSinceLastReceivedMessage);
					System.exit(0);
				}

				@Override
				public void omegleError(OmegleSession session, String string) {
					System.out.println("ERROR! " + string);
					System.exit(1);
				}
			});
		} catch (OmegleException e) {
			e.printStackTrace();
		}
		 */
		System.out.println(elizaProcessOmegle("hello"));
		System.out.println(elizaProcessOmegle("asl"));
		System.out.println(new String("asl").equals("asl"));
	}

	public String elizaProcessOmegle(String s) {
		if (	s.equals("hey") ||
				s.equals("hi") || 				
				s.contains("/") ||
				s.contains("\\")) {
			return eliza.processInput("hello"); 
		} else if (	s.equals("asl")) {
			int year = Calendar.getInstance().get(Calendar.YEAR);
			int yearElizaWasBorn = 1966;
			int elizaAge = year - yearElizaWasBorn;
			return "f/" + elizaAge + "/boston";
		} else if (s.equals("cool")) { 
			return eliza.processInput("yes");
		} else if (s.equals("good")) { 
			return eliza.processInput("yes");
		} else if (s.equals("great")) { 
			return eliza.processInput("yes");
		} else if (s.equals("poop")) { 
			return eliza.processInput("no");
		} else {
			return eliza.processInput(s);
		}
	}

	public void draw() {
		/*
		countsSinceLastReceivedMessage ++; 
		try {
			if (countsSinceLastReceivedMessage > 5 && lastMessageReceived != "") {

				session.send(eliza.processInput(lastMessageReceived), true);
				lastMessageReceived = "";
				countsSinceLastReceivedMessage = 0;
			}
		}
		catch (OmegleException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		 */

	}

	public static void main(String _args[]) {
		PApplet.main(new String[] { rewrite.Rewrite.class.getName() });
	}
}
